import  { ethers } from 'ethers';

const INFURA_PROJECT_ID = '16be73a339af47198391a283fa95f400';
const NETWORK = 'sepolia';
const PRIVATE_KEY = '0x8db4367c248edabb38603ce80e784caf3432a0637edf4cbd352a1ef2e8973fd1';
const provider = new ethers.InfuraProvider(NETWORK, INFURA_PROJECT_ID);

const wallet = new ethers.Wallet(PRIVATE_KEY, provider);

const abi = [{
    "anonymous":false,"inputs":
        [{
        "indexed":false,
            "internalType":"uint256",
            "name":"id","type":"uint256"
        },
            {"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"uint256","name":"price","type":"uint256"},{"indexed":false,"internalType":"address","name":"seller","type":"address"}],"name":"ItemListed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"address","name":"buyer","type":"address"}],"name":"ItemSold","type":"event"},{"inputs":[],"name":"getItems","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"address payable","name":"seller","type":"address"},{"internalType":"bool","name":"isSold","type":"bool"}],"internalType":"struct Market.Item[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"itemCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"items","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"address payable","name":"seller","type":"address"},{"internalType":"bool","name":"isSold","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"uint256","name":"_price","type":"uint256"}],"name":"listItem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"purchaseItem","outputs":[],"stateMutability":"payable","type":"function"}];
const bytecode = '0x6080604052348015600e575f80fd5b506113688061001c5f395ff3fe608060405260043610610049575f3560e01c8063410d59cc1461004d5780636bfb0d01146100775780638511c937146100a1578063bfb231d2146100c9578063d38ea5bf14610109575b5f80fd5b348015610058575f80fd5b50610061610125565b60405161006e9190610a0a565b60405180910390f35b348015610082575f80fd5b5061008b610302565b6040516100989190610a39565b60405180910390f35b3480156100ac575f80fd5b506100c760048036038101906100c29190610bb9565b610308565b005b3480156100d4575f80fd5b506100ef60048036038101906100ea9190610c13565b610488565b604051610100959493929190610ca4565b60405180910390f35b610123600480360381019061011e9190610c13565b61056b565b005b60605f60015467ffffffffffffffff81111561014457610143610a6b565b5b60405190808252806020026020018201604052801561017d57816020015b61016a6107b8565b8152602001906001900390816101625790505b5090505f600190505b60015481116102fa575f808281526020019081526020015f206040518060a00160405290815f82015481526020016001820180546101c390610d29565b80601f01602080910402602001604051908101604052809291908181526020018280546101ef90610d29565b801561023a5780601f106102115761010080835404028352916020019161023a565b820191905f5260205f20905b81548152906001019060200180831161021d57829003601f168201915b5050505050815260200160028201548152602001600382015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016003820160149054906101000a900460ff161515151581525050826001836102cb9190610d86565b815181106102dc576102db610db9565b5b602002602001018190525080806102f290610de6565b915050610186565b508091505090565b60015481565b5f811161034a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161034190610e77565b60405180910390fd5b60015f81548092919061035c90610de6565b91905055506040518060a0016040528060015481526020018381526020018281526020013373ffffffffffffffffffffffffffffffffffffffff1681526020015f15158152505f8060015481526020019081526020015f205f820151815f015560208201518160010190816103d19190611032565b50604082015181600201556060820151816003015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060808201518160030160146101000a81548160ff0219169083151502179055509050507f16244e47af8a7d2c923faa2cab44315c0514c7aa830682bbb9cc8f0d37ad754860015483833360405161047c9493929190611121565b60405180910390a15050565b5f602052805f5260405f205f91509050805f0154908060010180546104ac90610d29565b80601f01602080910402602001604051908101604052809291908181526020018280546104d890610d29565b80156105235780601f106104fa57610100808354040283529160200191610523565b820191905f5260205f20905b81548152906001019060200180831161050657829003601f168201915b505050505090806002015490806003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060030160149054906101000a900460ff16905085565b5f805f8381526020019081526020015f2090505f8211801561058f57506001548211155b6105ce576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016105c5906111b5565b60405180910390fd5b80600201543414610614576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161060b9061121d565b60405180910390fd5b8060030160149054906101000a900460ff1615610666576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161065d90611285565b60405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff16816003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16036106f7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106ee906112ed565b60405180910390fd5b806003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc3490811502906040515f60405180830381858888f1935050505015801561075d573d5f803e3d5ffd5b5060018160030160146101000a81548160ff0219169083151502179055507f7de4035ced290be6d7724645d43bad448b5d8cc76743ff4da172c2d8e1caa0f582336040516107ac92919061130b565b60405180910390a15050565b6040518060a001604052805f8152602001606081526020015f81526020015f73ffffffffffffffffffffffffffffffffffffffff1681526020015f151581525090565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f819050919050565b61083681610824565b82525050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f61087e8261083c565b6108888185610846565b9350610898818560208601610856565b6108a181610864565b840191505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6108d5826108ac565b9050919050565b6108e5816108cb565b82525050565b5f8115159050919050565b6108ff816108eb565b82525050565b5f60a083015f83015161091a5f86018261082d565b50602083015184820360208601526109328282610874565b9150506040830151610947604086018261082d565b50606083015161095a60608601826108dc565b50608083015161096d60808601826108f6565b508091505092915050565b5f6109838383610905565b905092915050565b5f602082019050919050565b5f6109a1826107fb565b6109ab8185610805565b9350836020820285016109bd85610815565b805f5b858110156109f857848403895281516109d98582610978565b94506109e48361098b565b925060208a019950506001810190506109c0565b50829750879550505050505092915050565b5f6020820190508181035f830152610a228184610997565b905092915050565b610a3381610824565b82525050565b5f602082019050610a4c5f830184610a2a565b92915050565b5f604051905090565b5f80fd5b5f80fd5b5f80fd5b5f80fd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b610aa182610864565b810181811067ffffffffffffffff82111715610ac057610abf610a6b565b5b80604052505050565b5f610ad2610a52565b9050610ade8282610a98565b919050565b5f67ffffffffffffffff821115610afd57610afc610a6b565b5b610b0682610864565b9050602081019050919050565b828183375f83830152505050565b5f610b33610b2e84610ae3565b610ac9565b905082815260208101848484011115610b4f57610b4e610a67565b5b610b5a848285610b13565b509392505050565b5f82601f830112610b7657610b75610a63565b5b8135610b86848260208601610b21565b91505092915050565b610b9881610824565b8114610ba2575f80fd5b50565b5f81359050610bb381610b8f565b92915050565b5f8060408385031215610bcf57610bce610a5b565b5b5f83013567ffffffffffffffff811115610bec57610beb610a5f565b5b610bf885828601610b62565b9250506020610c0985828601610ba5565b9150509250929050565b5f60208284031215610c2857610c27610a5b565b5b5f610c3584828501610ba5565b91505092915050565b5f82825260208201905092915050565b5f610c588261083c565b610c628185610c3e565b9350610c72818560208601610856565b610c7b81610864565b840191505092915050565b610c8f816108cb565b82525050565b610c9e816108eb565b82525050565b5f60a082019050610cb75f830188610a2a565b8181036020830152610cc98187610c4e565b9050610cd86040830186610a2a565b610ce56060830185610c86565b610cf26080830184610c95565b9695505050505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f6002820490506001821680610d4057607f821691505b602082108103610d5357610d52610cfc565b5b50919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f610d9082610824565b9150610d9b83610824565b9250828203905081811115610db357610db2610d59565b5b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b5f610df082610824565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203610e2257610e21610d59565b5b600182019050919050565b7f5072696365206d7573742062652067726561746572207468616e207a65726f005f82015250565b5f610e61601f83610c3e565b9150610e6c82610e2d565b602082019050919050565b5f6020820190508181035f830152610e8e81610e55565b9050919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f60088302610ef17fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610eb6565b610efb8683610eb6565b95508019841693508086168417925050509392505050565b5f819050919050565b5f610f36610f31610f2c84610824565b610f13565b610824565b9050919050565b5f819050919050565b610f4f83610f1c565b610f63610f5b82610f3d565b848454610ec2565b825550505050565b5f90565b610f77610f6b565b610f82818484610f46565b505050565b5b81811015610fa557610f9a5f82610f6f565b600181019050610f88565b5050565b601f821115610fea57610fbb81610e95565b610fc484610ea7565b81016020851015610fd3578190505b610fe7610fdf85610ea7565b830182610f87565b50505b505050565b5f82821c905092915050565b5f61100a5f1984600802610fef565b1980831691505092915050565b5f6110228383610ffb565b9150826002028217905092915050565b61103b8261083c565b67ffffffffffffffff81111561105457611053610a6b565b5b61105e8254610d29565b611069828285610fa9565b5f60209050601f83116001811461109a575f8415611088578287015190505b6110928582611017565b8655506110f9565b601f1984166110a886610e95565b5f5b828110156110cf578489015182556001820191506020850194506020810190506110aa565b868310156110ec57848901516110e8601f891682610ffb565b8355505b6001600288020188555050505b505050505050565b5f61110b826108ac565b9050919050565b61111b81611101565b82525050565b5f6080820190506111345f830187610a2a565b81810360208301526111468186610c4e565b90506111556040830185610a2a565b6111626060830184611112565b95945050505050565b7f4974656d20646f6573206e6f74206578697374000000000000000000000000005f82015250565b5f61119f601383610c3e565b91506111aa8261116b565b602082019050919050565b5f6020820190508181035f8301526111cc81611193565b9050919050565b7f506c65617365207375626d6974207468652061736b696e6720707269636500005f82015250565b5f611207601e83610c3e565b9150611212826111d3565b602082019050919050565b5f6020820190508181035f830152611234816111fb565b9050919050565b7f4974656d2068617320616c7265616479206265656e20736f6c640000000000005f82015250565b5f61126f601a83610c3e565b915061127a8261123b565b602082019050919050565b5f6020820190508181035f83015261129c81611263565b9050919050565b7f53656c6c65722063616e6e6f7420627579207468656972206f776e206974656d5f82015250565b5f6112d7602083610c3e565b91506112e2826112a3565b602082019050919050565b5f6020820190508181035f830152611304816112cb565b9050919050565b5f60408201905061131e5f830185610a2a565b61132b6020830184611112565b939250505056fea2646970667358221220a2677b480c27b4a9d890da51d1cc43df43ffe6d6d25b61247520eb12d6b3c48e64736f6c634300081a0033'; // 컴파일된 바이트코드

async function deployContract() {
    // ContractFactory 생성
    const contractFactory = new ethers.ContractFactory(abi, bytecode, wallet);

    console.log('배포 중...');

    // 스마트 컨트랙트 배포
    const contract = await contractFactory.deploy();


    console.log(`스마트 컨트랙트 배포 완료! 컨트랙트 주소: ${contract.target}`);
}

deployContract().catch((error) => {
    console.error('배포 중 오류 발생:', error);
});
